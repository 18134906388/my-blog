(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{382:function(a,t,r){a.exports=r.p+"assets/img/E-Program.a6a6e8c0.png"},407:function(a,t,r){"use strict";r.r(t);var e=r(45),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"江苏e项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#江苏e项目"}},[a._v("#")]),a._v(" 江苏E项目")]),a._v(" "),e("h2",{attrs:{id:"项目简介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目简介"}},[a._v("#")]),a._v(" 项目简介")]),a._v(" "),e("p",[a._v("E项目是江苏电网的能源侧项目，目标是打造一个数据中台，通过对接算子平台，最后实现无代码开发应用的能力。所谓数据中台，即实现数据的分层与水平解耦，沉淀公共的数据能力，笔者认为可分为三层，数据模型、数据服务与数据开发，通过数据建模实现跨域数据整合和知识沉淀，通过数据服务实现对于数据的封装和开放，快速、灵活满足上层应用的要求，通过数据开发工具满足个性化数据和应用的需要。本人有幸参与了该项目前端架构，下面总结一下前端开发中的问题。")]),a._v(" "),e("h2",{attrs:{id:"前端项目架构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前端项目架构"}},[a._v("#")]),a._v(" 前端项目架构")]),a._v(" "),e("p",[a._v("前端目前分为两个工程，一个前台工程，一个中台工程，对接第三方登录（客户要求）。开始时工程相互独立，有各自登录模块，后面屏蔽登录模块，统一通过第三方登录入口。目前前台定位为门户，大部分模块不需要鉴权功能,中台定义为工作台，对不同角色区分权限，菜单数据通过后台返回。"),e("br"),a._v(" "),e("img",{attrs:{src:r(382),alt:"E项目架构"}})]),a._v(" "),e("h2",{attrs:{id:"项目中遇到问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目中遇到问题"}},[a._v("#")]),a._v(" 项目中遇到问题")]),a._v(" "),e("p",[a._v("以下所有的前台工程工程统称为API工程，中台工程统称Web工程，")]),a._v(" "),e("h3",{attrs:{id:"工程合并"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#工程合并"}},[a._v("#")]),a._v(" 工程合并")]),a._v(" "),e("p",[a._v("开始两个工程在服务器中映射两个端口号就行访问，两个项目独立访问，后面需要集成，采用nginx映射同一端口在Web工程端口和/#/之间增加一层路径/platform/，这样不会因为浏览器同源策略导致两个工程不能共享浏览器session，前台通过点击工作台跳转中台。这里需要注意VUE脚手架需要再配置一层路径 "),e("code",[a._v("publicPath: '/platform/'")]),a._v("。\n同时nginx也要同步配置")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("server {\n  listen 80;\n  server_name web-platform;\n  root /data/store/dist;\n  include /etc/nginx/default.d/*.conf;\n\n  location ~* (swagger-ui.html)$ {\n    deny all;\n  }\n  location / {\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n    client_max_body_size 20m;\n    client_body_buffer_size 128k;\n    proxy_connect_timeout 5;\n    proxy_send_timeout 60;\n    proxy_read_timeout 60;\n    expires 0;\n    index index.html;\n  }\n  location ^~ /platform/ {\n    alias /data/platform/dist/;\n    try_files $uri $uri/ /index.html;\n  }\n  location ^~ /apimanager/ {\n    alias /data/swagger/dist/;\n    try_files $uri $uri/ /index.html;\n  }\n  location ^~ /appEngine/ {\n    alias /data/edaas/demo630/;\n    try_files $uri $uri/ /index.html;\n  }\n  location ^~ /cop/ {\n    alias /data/cop/dist/;\n    try_files $uri $uri/ /index.html;\n  }\n  location ^~ /iotcenter/ {\n    alias /data/iotcenter/dist/;\n    try_files $uri $uri/ /index.html;\n  }\n  location ^~ /datacenter/ {\n    alias /data/datacenter/dist/;\n    try_files $uri $uri/ /index.html;\n  }\n\n  location ^~ /store/ {\n    alias /data/store/dist/;\n    try_files $uri $uri/ /index.html;\n  }\n  location ^~ /storemanager/ {\n    alias /data/store/storemanager/;\n    try_files $uri $uri/ /index.html;\n  }\n\n\n  location /gw {\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    client_max_body_size 20m;\n    rewrite ^.+gw/(.*)$ /$1 break;\n    proxy_pass http://127.0.0.1:18902;\n    proxy_http_version 1.1;\n  }\n  location /resource {\n    rewrite ^.?resource/(.*)$ /$1 break;\n    proxy_pass http://127.0.0.1:18904;\n    proxy_http_version 1.1;\n  }\n\n  error_page 404 /404.html;\n  location = /40x.html {\n  }\n\n  error_page 500 502 503 504 /50x.html;\n  location = /50x.html {\n  }\n\n  location ^~ /file/ {\n    alias /data/files/;\n  }\n\n}\n")])])]),e("h3",{attrs:{id:"大屏报表拖拽"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#大屏报表拖拽"}},[a._v("#")]),a._v(" 大屏报表拖拽")]),a._v(" "),e("p",[a._v("对每个报表组件化，使用"),e("code",[a._v("@dragstart @dragend @drop @dragover.prevent")]),a._v("去对拖动事件就行捕获，采用:is=''对组件动态实例化。\n"),e("a",{attrs:{href:"https://www.jianshu.com/p/4d997bd855d3",target:"_blank",rel:"noopener noreferrer"}},[a._v("Vue Drag and Drop"),e("OutboundLink")],1),a._v("\n也可以采用比较成熟的vue-drag-drop库去实现。")]),a._v(" "),e("h3",{attrs:{id:"页面被iframe嵌套后出现拒绝了我们的连接请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#页面被iframe嵌套后出现拒绝了我们的连接请求"}},[a._v("#")]),a._v(" 页面被iframe嵌套后出现拒绝了我们的连接请求")]),a._v(" "),e("p",[a._v("因为对象服务器为http响应头设置了"),e("code",[a._v("X-Frame-Options: sameorigin")]),a._v("，这样页面就不能跨域通过iframe标签加载了。\n解决办法：通过nginx设置一层正向代理。")]),a._v(" "),e("h2",{attrs:{id:"项目亮点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目亮点"}},[a._v("#")]),a._v(" 项目亮点")]),a._v(" "),e("h3",{attrs:{id:"工具函数包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#工具函数包"}},[a._v("#")]),a._v(" 工具函数包")]),a._v(" "),e("p",[a._v("对于一些常用的工具函数封装到一个npm包中统一管理，方便后续项目集成使用。 "),e("code",[a._v("npm install supper-tools")])]),a._v(" "),e("h3",{attrs:{id:"简单微前端功能的实现"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#简单微前端功能的实现"}},[a._v("#")]),a._v(" 简单微前端功能的实现")]),a._v(" "),e("p",[a._v("由于整个数据中台由基础管控平台、物联中心、数据中心、swagger平台等多个前端工程组成、后续可能还要集成更多的工程。如何实现一个 多个前端工程可以任意拼装成一个工程，并且每个工程依然可以单独部署使用。\n最后在基础管理平台上边实现了这个功能，其他平台任意页面可以集成在基础管理平台中作为一个菜单，菜单之间可以相互交互。\n缺点：使用iframe对页面嵌套，使得整个工程不太灵活")])])}),[],!1,null,null,null);t.default=n.exports}}]);